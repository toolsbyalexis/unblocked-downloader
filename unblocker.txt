$b64 = "Q2xlYXItSG9zdA0KJEhvc3QuVUkuUmF3VUkuV2luZG93VGl0bGUgPSAiT3BpdW0gTGF1bmNoZXIgLSBAcmVwX29uaWciDQoNCiRCbHVlYm9va1BhdGggPSAiJGVudjpMT0NBTEFQUERBVEFcUHJvZ3JhbXNcYmx1ZWJvb2siDQppZiAoIShUZXN0LVBhdGggJEJsdWVib29rUGF0aCkpIHsNCiAgICBOZXctSXRlbSAtSXRlbVR5cGUgRGlyZWN0b3J5IC1QYXRoICRCbHVlYm9va1BhdGggfCBPdXQtTnVsbA0KfQ0KDQpmdW5jdGlvbiBXcml0ZS1Db2xvciB7DQogICAgcGFyYW0gKCRUZXh0LCAkQ29sb3IpDQogICAgV3JpdGUtSG9zdCAkVGV4dCAtRm9yZWdyb3VuZENvbG9yICRDb2xvcg0KfQ0KDQpmdW5jdGlvbiBMYXVuY2hJZkV4aXN0cygkbmFtZSl7DQogICAgJGZpbGUgPSBHZXQtQ2hpbGRJdGVtICRCbHVlYm9va1BhdGggLVJlY3Vyc2UgLUZpbHRlciAkbmFtZSAtRXJyb3JBY3Rpb24gU2lsZW50bHlDb250aW51ZSB8IFNlbGVjdC1PYmplY3QgLUZpcnN0IDENCiAgICBpZiAoJGZpbGUpIHsgU3RhcnQtUHJvY2VzcyAkZmlsZS5GdWxsTmFtZTsgcmV0dXJuICR0cnVlIH0NCiAgICByZXR1cm4gJGZhbHNlDQp9DQoNCmZ1bmN0aW9uIERvd25sb2FkLVJvYmxveCB7DQogICAgaWYgKExhdW5jaElmRXhpc3RzICJSb2Jsb3hQbGF5ZXJCZXRhLmV4ZSIpIHsgcmV0dXJuIH0NCg0KICAgICR6aXBQYXRoID0gIiRlbnY6VEVNUFxyb2Jsb3guemlwIg0KICAgICR1cmwgPSAiaHR0cHM6Ly93d3cuZGlyZWN0ZmlsZXMubGluay9DUU83VzdUM0wiDQoNCiAgICBXcml0ZS1Db2xvciAiRG93bmxvYWRpbmcgUm9ibG94Li4uIiBZZWxsb3cNCiAgICBJbnZva2UtV2ViUmVxdWVzdCAkdXJsIC1PdXRGaWxlICR6aXBQYXRoDQoNCiAgICBXcml0ZS1Db2xvciAiRXh0cmFjdGluZyBSb2Jsb3guLi4iIFllbGxvdw0KICAgIEV4cGFuZC1BcmNoaXZlIC1QYXRoICR6aXBQYXRoIC1EZXN0aW5hdGlvblBhdGggJEJsdWVib29rUGF0aCAtRm9yY2UNCiAgICBSZW1vdmUtSXRlbSAkemlwUGF0aCAtRm9yY2UNCg0KICAgIGlmICgtbm90IChMYXVuY2hJZkV4aXN0cyAiUm9ibG94UGxheWVyQmV0YS5leGUiKSkgew0KICAgICAgICBXcml0ZS1Db2xvciAiRVJST1I6IFJvYmxveFBsYXllckJldGEuZXhlIG5vdCBmb3VuZC4iIFJlZA0KICAgICAgICBQYXVzZQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gRG93bmxvYWQtTWluZWNyYWZ0IHsNCiAgICBpZiAoTGF1bmNoSWZFeGlzdHMgInByaXNtbGF1bmNoZXIuZXhlIikgeyByZXR1cm4gfQ0KDQogICAgJHppcFBhdGggPSAiJGVudjpURU1QXHByaXNtLnppcCINCiAgICAkdXJsID0gImh0dHBzOi8vZ2l0aHViLmNvbS9EaWVnaXdnL1ByaXNtTGF1bmNoZXItQ3JhY2tlZC9yZWxlYXNlcy9kb3dubG9hZC8xMC4wLjIvUHJpc21MYXVuY2hlci1XaW5kb3dzLU1TVkMtUG9ydGFibGUtMTAuMC4yLnppcCINCg0KICAgIFdyaXRlLUNvbG9yICJEb3dubG9hZGluZyBNaW5lY3JhZnQuLi4iIFllbGxvdw0KICAgIEludm9rZS1XZWJSZXF1ZXN0ICR1cmwgLU91dEZpbGUgJHppcFBhdGgNCg0KICAgIFdyaXRlLUNvbG9yICJFeHRyYWN0aW5nIE1pbmVjcmFmdC4uLiIgWWVsbG93DQogICAgRXhwYW5kLUFyY2hpdmUgLVBhdGggJHppcFBhdGggLURlc3RpbmF0aW9uUGF0aCAkQmx1ZWJvb2tQYXRoIC1Gb3JjZQ0KICAgIFJlbW92ZS1JdGVtICR6aXBQYXRoIC1Gb3JjZQ0KDQogICAgaWYgKC1ub3QgKExhdW5jaElmRXhpc3RzICJwcmlzbWxhdW5jaGVyLmV4ZSIpKSB7DQogICAgICAgIFdyaXRlLUNvbG9yICJFUlJPUjogcHJpc21sYXVuY2hlci5leGUgbm90IGZvdW5kLiIgUmVkDQogICAgICAgIFBhdXNlDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBTaG93TWVudSB7DQogICAgQ2xlYXItSG9zdA0KICAgIFdyaXRlLUNvbG9yICJPcGl1bSBMYXVuY2hlciAtIEByZXBfb25pZyIgTWFnZW50YQ0KICAgIFdyaXRlLUhvc3QgIiINCiAgICBXcml0ZS1Db2xvciAiWzFdIExhdW5jaCBSb2Jsb3giIFJlZA0KICAgIFdyaXRlLUNvbG9yICJbMl0gTGF1bmNoIE1pbmVjcmFmdCIgR3JlZW4NCiAgICBXcml0ZS1Ib3N0ICIiDQogICAgV3JpdGUtQ29sb3IgIklmIHlvdSB3YW50IG1lIHRvIGFkZCBtb3JlLCBqb2luIHRoZSBkaXNjb3JkIHNlcnZlciBhbmQgbGV0IG1lIGtub3c6IGRpc2NvcmQuZ2cvSnp4RUdBOFo0cSIgQmx1ZQ0KfQ0KDQp3aGlsZSAoJHRydWUpIHsNCiAgICBTaG93TWVudQ0KICAgICRrZXkgPSAkSG9zdC5VSS5SYXdVSS5SZWFkS2V5KCJOb0VjaG8sSW5jbHVkZUtleURvd24iKS5DaGFyYWN0ZXINCg0KICAgIHN3aXRjaCAoJGtleSkgew0KICAgICAgICAiMSIgeyBEb3dubG9hZC1Sb2Jsb3ggfQ0KICAgICAgICAiMiIgeyBEb3dubG9hZC1NaW5lY3JhZnQgfQ0KICAgICAgICBkZWZhdWx0IHsgY29udGludWUgfQ0KICAgIH0NCn0NCg=="
$code = [System.Text.Encoding]::UTF8.GetString([Convert]::FromBase64String($b64))
Invoke-Expression $code
